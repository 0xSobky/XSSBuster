!function(window,Object,Array){var inputs,origin,_origin,win,_Function,_eval,_setTimeout,_setInterval,_atob,some,_cookieDesc,_localStorage,_appendChild,_replaceChild,_insertBefore,elPrototype,isSafeArg,guardMethod,_execScript,_setImmediate,_sessionStorage,guardSink,guardStorage,guardWrite,toSafeStr,_write,_writeln,_innerHTML,_outerHTML,getOwnPropertyDescriptor,genDescriptor,_insertAdjacentHTML,_createContextualFragment,Rprototype,getPrototypeOf,_cookie;if(window){inputs=[],origin=window.location.origin||window.location.protocol+"//"+window.location.host;var getType=function(input){var toString=Object.prototype.toString;if("string"==typeof input||"[object String]"===toString.call(input))return"string";if("[object Object]"===toString.call(input))return"object";try{if(Array.isArray(input))return"array"}catch(e){if("[object Array]"===toString.call(input))return"array"}return"other"},toPlain=function(input){var eu=window.encodeURI,du=window.decodeURI,euc=window.encodeURIComponent,duc=window.decodeURIComponent,depth=0,revMethod=[],deEncode=function(input){var es,ues,eusExtend,_input;try{for(;duc(input)!==input;)_input=duc(input),du(input)===_input?(input=du(input),revMethod.push(eu)):(input=_input,revMethod.push(euc)),++depth}catch(e){if("function"==typeof window.escape&&"function"==typeof window.unescape?(es=window.escape,ues=window.unescape):(eusExtend=function(func){var charset=/[\w\s\/\-\^+=_$#@!&*\|,.?:<>\[\]()'";{}]|[^\x00-\x7F]|%(?:40|2[B-F]|2[0-9]|3[A-E]|[57][B-D])/gi;return function(string){return string=string.match(charset),string?func(string.join("")):null}},es=eusExtend(euc),ues=eusExtend(duc)),input=ues(input),revMethod.push(es),++depth,ues(input)!==input)return deEncode(input)}return input};return input=deEncode(input),{output:input,depth:depth,revMethod:revMethod}},reEncode=function(input,depth,revMethod){for(;depth--;)input=revMethod[depth](input);return input},bRegex=/\{\{|\}\}|&#?\w{2,7};?|on[a-z]+\W*?=|(?:(?:d\W*a\W*t\W*a\W*?)|(?:v\W*b|j\W*a\W*v\W*a)\W*s\W*c\W*r\W*i\W*p\W*t\W*?):/gi,sanitize=function(input){var _input,propSanitize,index,keys,hasOwnProperty,prop,item,wRegex=/[^\w\s\/\-\^+=$#@!&*\|,;:.?%()\[\]{}]/gi,isModified=!1;if("string"===getType(input)){if(/\S/.test(input)){if(/%\w{2}/.test(input)&&(_input=toPlain(input),input=_input.output),wRegex.test(input)&&(input=input.replace(wRegex,""),isModified=!0),bRegex.test(input)){do input=input.replace(bRegex,""),bRegex.lastIndex=0;while(bRegex.test(input));isModified=!0}inputs.push(input),_input&&(input=reEncode(input,_input.depth,_input.revMethod))}}else if("object"===getType(input)){propSanitize=function(prop){var value=sanitize(input[prop]);value!==!1&&(input[prop]=value,isModified=!0)};try{keys=Object.getOwnPropertyNames(input);for(index in keys)propSanitize(keys[index])}catch(e){hasOwnProperty=Object.prototype.hasOwnProperty;for(prop in input)hasOwnProperty.call(input,prop)&&propSanitize(prop)}}else if("array"===getType(input))for(index=input.length;index--;)item=sanitize(input[index]),item!==!1&&(input[index]=item,isModified=!0);return!!isModified&&input},auditUrl=function(urlObj){var pathname,search,_isModified,pIndex,_pIndex,aParam,sParam,hash,isModified=!1;if(pathname=sanitize(urlObj.pathname),pathname!==!1&&(urlObj.pathname=pathname,isModified=!0),search=urlObj.search){for(_isModified=!1,search=search.slice(1).split("&"),pIndex=search.length;pIndex--;){if(aParam=search[pIndex].split("="),aParam.length<3)sParam=sanitize(aParam[0]),sParam!==!1&&(aParam[0]=sParam,_isModified=!0),aParam[1]&&(sParam=sanitize(aParam[1]),sParam!==!1&&(aParam[1]=sParam,_isModified=!0));else for(_pIndex=aParam.length;_pIndex--;)sParam=sanitize(aParam[_pIndex]),sParam!==!1&&(_isModified=!0,aParam[_pIndex]=sParam);_isModified&&(search[pIndex]=aParam.join("="))}_isModified&&(urlObj.search=search.join("&"),isModified=!0)}return hash=urlObj.hash.slice(1),hash&&(hash=sanitize(hash),hash!==!1&&(urlObj.hash=hash,isModified=!0)),!!isModified&&urlObj.href},parseUrl=function(url){var uriParseRe,uriArr;try{url=new URL(url)}catch(e){uriParseRe=/^(\w+:\/\/)?([^\/:?#]*)(:\d+)?([^?#]*)(\?[^#]+)?(#.+)?/,uriArr=url.match(uriParseRe),url={get href(){var frags=uriArr.slice(1,uriArr.length);return frags.join("")},get protocol(){return uriArr[1].slice(0,-2)},set protocol(value){uriArr[1]=value},get hostname(){return uriArr[2]},set hostname(value){uriArr[2]=value},get port(){return uriArr[3]?uriArr[3].slice(1):""},set port(value){uriArr[3]=":"+value},get host(){return uriArr[2]+(uriArr[3]||"")},set host(value){value=value.split(":"),this.hostname=value[0]||this.hostname,this.port=value[1]||this.port},get pathname(){return uriArr[4]||"/"},set pathname(value){uriArr[4]="/"+value},get search(){return uriArr[5]||""},set search(value){uriArr[5]=value?"?"+value:""},get hash(){return uriArr[6]||""},set hash(value){uriArr[6]=value?"#"+value:""}}}return url},addListener=function(){return window.addEventListener?function(target,equiv,evName,callback){var _addEventListener="window"===equiv?window.addEventListener:document.addEventListener;_addEventListener.call(target,evName,callback)}:function(target,equiv,evName,callback){var _callback,_attachEvent="window"===equiv?window.attachEvent:document.attachEvent;"DOMContentLoaded"===evName?(_callback=function(){"interactive"===target.readyState&&callback()},_attachEvent.call(target,"onreadystatechange",_callback)):_attachEvent.call(target,"on"+evName,callback)}}(),defineProperties=function(obj,properties){for(var prop,_value,index=properties.length;index--;)prop=properties[index],_value=prop.value,prop=prop.default?{value:_value,enumerable:!0,writable:!0,configurable:!0}:prop;try{Object.defineProperties(obj,properties)}catch(e){}},auditWinName=function(winObj){var _name=winObj.name;defineProperties(winObj,{name:{get:function(){return _name},set:function(val){var sVal=sanitize(val);_name=sVal!==!1?sVal:val},enumerable:!0}}),winObj.name=_name},auditWin=function(winObj){var name,title,referrer,_onhashchange,_onmessage,auditFrames;_onhashchange=function(){var hash=sanitize(winObj.location.hash.slice(1));hash!==!1&&(winObj.location.hash=hash)},_onmessage=function(ev){var data,index,port,ports=ev.ports,_origin=ev.origin||ev.originalEvent.origin;if(_origin!==origin&&(data=sanitize(ev.data),data!==!1&&defineProperties(ev,{data:{value:data,default:!0}}),ports))for(index=ports.length;index--;)port=ports[index],port.onmessage=_onmessage},addListener(winObj,"window","hashchange",_onhashchange),addListener(winObj,"window","message",_onmessage),auditUrl(winObj.location),name=winObj.name,name&&(name=sanitize(name),name!==!1&&(winObj.name=name)),title=sanitize(winObj.document.title),title!==!1&&(winObj.document.title=title),referrer=winObj.document.referrer,referrer&&(referrer=auditUrl(parseUrl(referrer)),referrer!==!1&&defineProperties(winObj.document,{referrer:{value:referrer,default:!0}})),auditFrames=function(){var fIndex,currentFrame,getElementsByTagName=document.getElementsByTagName,frames=getElementsByTagName.call(winObj.document,"iframe"),auditFrame=function(currentFrame){var fWindow;try{fWindow=currentFrame.contentWindow,currentFrame.src!==fWindow.location.href&&(auditWinName(fWindow),auditWin(fWindow))}catch(e){}};for(fIndex=frames.length;fIndex--;)currentFrame=frames[fIndex],function(currentFrame){addListener(currentFrame,"document","load",function(){auditFrame(currentFrame)})}(currentFrame)},addListener(winObj.document,"document","DOMContentLoaded",auditFrames)};if(auditWin(window),window!==top){win=parent;try{_origin=win.location.origin||win.location.protocol+"//"+win.location.host}catch(e){}do try{_origin!==origin&&(auditWinName(win),auditWin(win))}catch(e){continue}finally{win=win.parent}while(win!==top)}_Function=window.Function,_eval=window.eval,_setInterval=window.setInterval,_setTimeout=window.setTimeout,elPrototype=Element.prototype,_appendChild=elPrototype.appendChild,_replaceChild=elPrototype.replaceChild,_insertBefore=elPrototype.insertBefore,some=Array.prototype.some||function(fn){for(var index=this.length;index--;)if(fn(this[index]))return!0;return!1},isSafeArg=function(){var validate=function(arg){var isTainted=function(taint){return isNaN(taint)&&taint.length>6&&arg.indexOf(taint)!==-1};return arg=toPlain(arg).output,some.call(inputs,isTainted)};return!some.call(arguments,validate)},toSafeStr=function(str){return bRegex.test(str)&&(str=str.replace(bRegex,"")),str},guardMethod=function(method){return function(node){var nodeName=node.name,isUnsafeEl=function(node){var childScripts,attribs,index,attrib,attribName;if(node.hasChildNodes&&node.hasChildNodes()&&(childScripts=node.getElementsByTagName("script"),some.call(childScripts,isUnsafeEl)))return!0;if("SCRIPT"===nodeName)return!isSafeArg(node.text)||!isSafeArg(node.src);if("OBJECT"===nodeName&&!isSafeArg(node.data))return!0;if(node.hasAttributes&&node.hasAttributes())for(attribs=node.attributes,index=attribs.length;index--;)attrib=attribs[index],attribName=attrib.name,/^on./.test(attribName)&&!isSafeArg(attrib.value)&&node.removeAttribute(attribName)};return isUnsafeEl(node)&&(node.innerHTML="",node.hasAttribute("src")&&node.removeAttribute("src")),method.apply(this,arguments)}},elPrototype.appendChild=guardMethod(_appendChild),elPrototype.replaceChild=guardMethod(_replaceChild),elPrototype.insertBefore=guardMethod(_insertBefore),Rprototype=Range.prototype,getOwnPropertyDescriptor=function(){try{return Object.getOwnPropertyDescriptor.apply(this,arguments)}catch(e){}},_innerHTML=getOwnPropertyDescriptor(elPrototype,"innerHTML"),_outerHTML=getOwnPropertyDescriptor(elPrototype,"outerHTML"),_createContextualFragment=Rprototype.createContextualFragment,Rprototype.createContextualFragment=function(tagStr){return isSafeArg(tagStr)||(tagStr=toSafeStr(tagStr)),_createContextualFragment.call(this,tagStr)},genDescriptor=function(prop){return{get:function(){return prop.get.call(this)},set:function(val){return isSafeArg(val)||(val=toSafeStr(val)),prop.set.call(this,val)}}},Object.defineProperties(elPrototype,{innerHTML:genDescriptor(_innerHTML),outerHTML:genDescriptor(_outerHTML)}),_insertAdjacentHTML=elPrototype.insertAdjacentHTML,_insertAdjacentHTML&&(elPrototype.insertAdjacentHTML=function(position,html){return isSafeArg(html)||(html=toSafeStr(html)),_insertAdjacentHTML.call(this,position,html)}),_write=document.write,_writeln=document.writeln,guardWrite=function(writeFn){return function(str){var els,el;isSafeArg(str)?writeFn.call(document,str):(str=toSafeStr(str),els=document.getElementsByTagName("*"),el=els[els.length-1],el.parentElement.innerHTML=str)}},document.write=guardWrite(_write),document.writeln=guardWrite(_writeln),Function=function(){var construct=function(){var fn=_Function.apply(null,arguments);fn.constructor=Function;try{Object.setPrototypeOf(fn,Function)}catch(e){fn.__proto__=Function}return fn};return isSafeArg.apply(null,arguments)?construct.apply(null,arguments):construct()},Function.prototype=Function,guardSink=function(sinkFn){return function(){if(isSafeArg.apply(null,arguments))return sinkFn.apply(this,arguments)}},window.eval=guardSink(_eval),window.setTimeout=guardSink(_setTimeout),window.setInterval=guardSink(_setInterval),"function"==typeof window.atob&&(_atob=window.atob,window.atob=function(str){return isSafeArg(str)?_atob(str):str=sanitize(_atob(str))}),"function"==typeof window.execScript&&(_execScript=window.execScript,window.execScript=guardSink(_execScript)),"function"==typeof window.setImmediate&&(_setImmediate=window.setImmediate,window.setImmediate=guardSink(_setImmediate)),getPrototypeOf=function(){try{return Object.getPrototypeOf.apply(this,arguments)}catch(e){}},_cookieDesc=function(){try{return getOwnPropertyDescriptor(document,"cookie")||getOwnPropertyDescriptor(getPrototypeOf(document),"cookie")||{get:document.__lookupGetter__("cookie"),set:document.__lookupSetter__("cookie")}}catch(e){}}(),_cookie=document.cookie,defineProperties(document,{cookie:{get:function(){try{return _cookieDesc.get.call(this)}catch(e){return _cookie}},set:function(val){if(isSafeArg(val))try{return _cookieDesc.set.call(this,val)}catch(e){_cookie+=";"+val}}}}),guardStorage=function(storageObj){return{setItem:function(key,value){isSafeArg(key,value)&&storageObj.setItem(key,value)},getItem:function(key){return storageObj.getItem(key)}}},window.localStorage&&(_localStorage=window.localStorage,delete window.localStorage,window.localStorage=guardStorage(_localStorage)),window.sessionStorage&&(_sessionStorage=window.sessionStorage,delete window.sessionStorage,window.sessionStorage=guardStorage(_sessionStorage))}}(window,Object,Array);
